import{r as l,j as e}from"./index-D49GhdXc.js";import{F as H,b as M}from"./DefaultLayout-BYJO0kab.js";import{R as g,J as f}from"./jszip.min-Arv4sAtc.js";import{C as u}from"./ColorBox--8p0fZTq.js";import{F as d}from"./FileSaver.min-fqMPiXjD.js";import{F as P}from"./FilterTable-KTbhdHBd.js";import{g as z,h as _,i as N,j as G,k as J,C as h,m as L,l as Y}from"./CSmartTable-D0DrC7VM.js";import"./ColorUtils-Dcf7vEzi.js";const ee=()=>{l.useState(30);const[o,y]=l.useState([]),[j,c]=l.useState([]),[b,m]=l.useState(!0),[w,p]=l.useState(!1),[i,v]=l.useState(null),[S,D]=l.useState(""),[C,T]=l.useState("all");l.useState(!0),l.useEffect(()=>{(async()=>{try{const s=await fetch("http://127.0.0.1:8080/public/texture/");if(!s.ok)throw new Error("Network response was not ok");const n=(await s.json()).map(r=>({id:r.id,isTransparent:r.isTransparent,averageRgb:r.averageRgb,animationDirection:r.animationDirection,animationSpeed:r.animationSpeed,spriteIds:r.fileIds}));y(n.sort((r,E)=>r.id-E.id)),c(n)}catch(s){console.error("Error fetching data:",s)}finally{m(!1)}})()},[]);const x=t=>{v(t),p(!0)},I=t=>{const s=t.target.value;D(s);const a=o.filter(n=>n.id.toString().includes(s));c(a)},k=t=>{const s=t.target.value;T(s);const a=o.filter(n=>s==="all"?!0:s==="true"?n.isTransparent:!n.isTransparent);c(a)},F=async t=>{if(!(!t||t.spriteIds.length===0))if(t.spriteIds.length===1){const a=await(await fetch(`http://127.0.0.1:8080/public/sprite/${t.spriteIds[0]}.png`)).blob();d.saveAs(a,`${t.spriteIds[0]}.png`)}else{const s=new f;await Promise.all(t.spriteIds.map(async a=>{const r=await(await fetch(`http://127.0.0.1:8080/public/sprite/${a}.png`)).blob();s.file(`${a}.png`,r)})),s.generateAsync({type:"blob"}).then(a=>{d.saveAs(a,`textures_${t.id}.zip`)})}},R=async()=>{const t=new f;await Promise.all(o.map(async s=>{if(s.spriteIds.length===1){const n=await(await fetch(`http://127.0.0.1:8080/public/sprite/${s.spriteIds[0]}.png`)).blob();t.file(`${s.spriteIds[0]}.png`,n)}else await Promise.all(s.spriteIds.map(async a=>{const r=await(await fetch(`http://127.0.0.1:8080/public/sprite/${a}.png`)).blob();t.file(`${a}.png`,r)}))})),t.generateAsync({type:"blob"}).then(s=>{d.saveAs(s,"all_textures.zip")})},A=[{key:"id",label:"ID",_style:{width:"30%"},filter:!1,sorter:!1},{key:"transparency",label:"Transparency",filter:!1,sorter:!1},{key:"averageRgb",label:"Average RGB",filter:!1,sorter:!1},{key:"animationDirection",label:"Direction",filter:!1,sorter:!1},{key:"animationSpeed",label:"Speed",filter:!1,sorter:!1},{key:"sprites",label:"Sprites",filter:!1,sorter:!1}],$={transparency:t=>e.jsx("td",{children:t.isTransparent?"Yes":"No"}),averageRgb:t=>e.jsx("td",{children:e.jsx(u,{width:80,height:80,packedHsl:t.averageRgb,tooltip:!0,showHex:!0})}),sprites:t=>e.jsx("td",{style:{display:"flex",gap:"10px"},children:t.spriteIds.map(s=>e.jsx(g,{rounded:!0,thumbnail:!0,id:s,width:80,height:80,keepAspectRatio:!0,onClick:()=>x(t)},s))})},B=e.jsxs("div",{style:{display:"flex",gap:"20px",alignItems:"center",marginBottom:"10px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[e.jsx(H,{style:{marginRight:"8px"}}),e.jsx(L,{type:"text",placeholder:"Search ID",value:S,onChange:I,style:{width:"150px"}})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[e.jsx(M,{style:{marginRight:"8px"}})," ",e.jsxs(Y,{value:C,onChange:k,style:{width:"150px"},children:[e.jsx("option",{value:"all",children:"All"}),e.jsx("option",{value:"true",children:"Transparent"}),e.jsx("option",{value:"false",children:"Opaque"})]})]}),e.jsx(h,{color:"primary",onClick:R,style:{marginLeft:"auto"},children:"Download All Textures"})]});return e.jsxs(e.Fragment,{children:[e.jsx(P,{pageTitle:"Textures",tableData:j,columns:A,scopedColumns:$,loading:b,customFilters:B,handleRowClick:x}),i&&e.jsxs(z,{alignment:"center",visible:w,onClose:()=>p(!1),children:[e.jsx(_,{children:e.jsx(N,{children:"Texture Details"})}),e.jsxs(G,{children:[e.jsxs("p",{children:[e.jsx("strong",{children:"ID:"})," ",i.id]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Transparent:"})," ",i.isTransparent?"Yes":"No"]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:"10px"},children:[e.jsx("strong",{style:{marginRight:"10px"},children:"Average RGB:"}),e.jsx(u,{width:55,height:55,tooltip:!0,showHex:!0,packedHsl:i.averageRgb})]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Animation Direction:"})," ",i.animationDirection]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Animation Speed:"})," ",i.animationSpeed]}),e.jsx("p",{children:e.jsx("strong",{children:"Sprites:"})}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"10px"},children:i.spriteIds.map(t=>e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx(g,{id:t,width:80,height:80,keepAspectRatio:!0}),e.jsx("p",{children:t})]},t))})]}),e.jsxs(J,{children:[e.jsx(h,{color:"primary",onClick:()=>F(i),children:"Download"}),e.jsx(h,{color:"secondary",onClick:()=>p(!1),children:"Close"})]})]})]})};export{ee as default};
//# sourceMappingURL=Textures-C06NUXom.js.map
