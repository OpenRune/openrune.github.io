import{r as a,R as p,P as o,j as e}from"./index-BubZJH7A.js";import{R as k,J as K}from"./jszip.min-BIPKHUoq.js";import{F as Q}from"./FileSaver.min-Bz8tn3-L.js";import{F as W}from"./FilterTable-BVAP6-cN.js";import{d as D,b as u,a as E,o as Y,p as _,g as M,h as I,i as A,j as $,k as L,C as S}from"./CSmartTable-BoRP8CRl.js";import{f as ee}from"./DefaultLayout-Cltd-sQ0.js";var P=a.createContext({}),V=a.forwardRef(function(s,f){var t=s.children,h=s.className,m=D(s,["children","className"]);return p.createElement("div",u({className:E("progress-stacked",h),ref:f},m),p.createElement(P.Provider,{value:{stacked:!0}},t))});V.propTypes={children:o.node,className:o.string};V.displayName="CProgressStacked";var R=a.forwardRef(function(s,f){var t,h=s.children,m=s.animated,y=s.className,C=s.color,n=s.value,g=n===void 0?0:n,x=s.variant,b=D(s,["children","animated","className","color","value","variant"]),d=a.useContext(P).stacked;return p.createElement("div",u({className:E("progress-bar",(t={},t["bg-".concat(C)]=C,t["progress-bar-".concat(x)]=x,t["progress-bar-animated"]=m,t),y)},!d&&{style:{width:"".concat(g,"%")}},b,{ref:f}),h)});R.propTypes={animated:o.bool,children:o.node,className:o.string,color:o.oneOfType([Y,_]),value:o.number,variant:o.oneOf(["striped"])};R.displayName="CProgressBar";var B=a.forwardRef(function(s,f){var t=s.children,h=s.className,m=s.height,y=s.progressBarClassName,C=s.thin,n=s.value,g=s.white,x=D(s,["children","className","height","progressBarClassName","thin","value","white"]),b=a.useContext(P).stacked;return p.createElement("div",u({className:E("progress",{"progress-thin":C,"progress-white":g},h)},n!==void 0&&{role:"progressbar","aria-valuenow":n,"aria-valuemin":0,"aria-valuemax":100},{style:u(u({},m?{height:"".concat(m,"px")}:{}),b?{width:"".concat(n,"%")}:{}),ref:f}),p.Children.toArray(t).some(function(d){return d.type&&d.type.displayName==="CProgressBar"})?p.Children.map(t,function(d){if(p.isValidElement(d)&&d.type.displayName==="CProgressBar")return p.cloneElement(d,u(u({},n&&{value:n}),x))}):p.createElement(R,u({},y&&{className:y},{value:n},x),t))});B.propTypes={children:o.node,className:o.string,height:o.number,progressBarClassName:o.string,thin:o.bool,value:o.number,white:o.bool};B.displayName="CProgress";const ne=()=>{const[s,f]=a.useState([]),[t,h]=a.useState([]),[m,y]=a.useState(!0),[C,n]=a.useState(!1),[g,x]=a.useState(null),[b,d]=a.useState(""),[O,j]=a.useState(!1),[N,z]=a.useState(0);a.useEffect(()=>{(async()=>{try{const l=await fetch("http://127.0.0.1:8080/public/sprite/");if(!l.ok)throw new Error("Network response was not ok");const i=(await l.json()).map(c=>({id:c.id,offsetX:c.offsetX}));f(i.sort((c,v)=>c.id-v.id)),h(i)}catch(l){console.error("Error fetching data:",l)}finally{y(!1)}})()},[]);const T=async r=>{try{const l=await fetch(`http://127.0.0.1:8080/public/sprite/${r}`);if(!l.ok)throw new Error("Error fetching sprite");const w=await l.blob(),i=window.URL.createObjectURL(w),c=document.createElement("a");c.href=i,c.download=`sprite_${r}.png`,document.body.appendChild(c),c.click(),document.body.removeChild(c)}catch(l){console.error("Error downloading sprite:",l)}},J=async()=>{const r=new K;j(!0);const l=t.length;let w=0;for(const i of t){try{const v=await fetch(`http://127.0.0.1:8080/public/sprite/${i.id}`);if(v.ok){const G=await v.blob();r.file(`sprite_${i.id}.png`,G)}}catch(v){console.error(`Error downloading sprite ${i.id}:`,v)}w+=1;const c=Math.round(w/l*100);z(c)}r.generateAsync({type:"blob"}).then(i=>{Q.saveAs(i,"all_sprites.zip"),j(!1)})},U=r=>{const l=r.target.value;d(l);const w=s.filter(i=>i.id.toString().includes(l));h(w)},F=r=>{x(r),n(!0)},X=e.jsxs("div",{style:{display:"flex",gap:"20px",alignItems:"center",marginBottom:"10px"},children:[e.jsx("div",{style:{display:"flex",alignItems:"center"},children:e.jsx(ee,{type:"text",placeholder:"Search ID",value:b,onChange:U,style:{width:"150px",padding:"8px",marginRight:"8px"}})}),e.jsx(S,{color:"primary",onClick:J,style:{marginLeft:"auto"},children:"Download All Textures"})]}),Z=[{key:"id",label:"ID",_style:{width:"30%"},filter:!1,sorter:!1},{key:"sprite",label:"Sprite",filter:!1,sorter:!1}],H={sprite:r=>e.jsx("td",{children:e.jsx(k,{onClick:()=>F(r),rounded:!0,thumbnail:!0,id:r.id,width:40,height:40,keepAspectRatio:!0},r.id)})},q=({item:r})=>e.jsx(e.Fragment,{children:e.jsx(k,{id:r.id})});return e.jsxs(e.Fragment,{children:[e.jsx(W,{pageTitle:"Sprites",tableData:t,fetchData:()=>{},customFilters:X,columns:Z,scopedColumns:H,loading:m,CModalContent:q,handleRowClick:F,handleDownloadItemIcon:T}),e.jsxs(M,{alignment:"center",visible:C,onClose:()=>n(!1),children:[e.jsx(I,{children:e.jsx(A,{children:"Sprite Details"})}),e.jsx($,{children:g&&e.jsx(k,{id:g.id})}),e.jsxs(L,{children:[e.jsx(S,{color:"primary",onClick:()=>T(g.id),children:"Download Sprite"}),e.jsx(S,{color:"secondary",onClick:()=>n(!1),children:"Close"})]})]}),e.jsxs(M,{alignment:"center",visible:O,onClose:()=>j(!1),children:[e.jsx(I,{children:e.jsx(A,{children:"Downloading Sprites"})}),e.jsxs($,{children:[e.jsx("p",{children:"Zipping and downloading all sprites. Please wait..."}),e.jsx(B,{value:N,className:"mb-3"}),e.jsxs("p",{children:[N,"% completed"]})]}),e.jsx(L,{children:e.jsx(S,{color:"secondary",onClick:()=>j(!1),disabled:N<100,children:"Close"})})]})]})};export{ne as default};
//# sourceMappingURL=Sprites-BYsg5WBD.js.map
